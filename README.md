## Chookting

축팅(Chookting)은 축제의 순간들을 더욱 빛내줄 새로운 친구와의 만남을 연결하는 플랫폼입니다.
축팅을 통해 사용자는 자신의 특별한 순간을 포착하고, 다양한 사람들과 그 기쁨을 공유할 수 있습니다


## 사용기술 및 협업 툴


- JDK 17
- Springboot 2.7.15
- SpringSecurity
- MySQL : 8.0.33
- Redis 7.2
- OAuth2Client
- java-jwt 4.3.0

## 제공 기능 및 역할


| 기능 | 설명 | 담당자 |
| --- | --- | --- |
| 게시물 업로드 | 사진과 해시태그 등을 활용해 게시물을 업로드 | 고범수, 황대선 |
| 메인 피드 조회 | 메인 피드의 게시글들을 무한 스크롤 방식으로 제공 및 상세 조회 | 고범수 |
| 인기 피드 조회 | 인기 피드의 게시글을 인기도에 따라 선별하여 랜덤으로 제공 및 상세 조회 | 황대선 |
| 조회수 | 조회수 정책에 따라 게시글 별 조회수 산정 | 황대선 |
| 추천수 | 각 피드 별 받은 조회수 산정 | 고범수 |
| 폭죽 사용 | 축팅 내 재화인 폭죽을 사용하여 해당 게시글 사진의 인스타 아이디를 제공 | 고범수, 황대선 |
| 폭죽 제공 | 폭죽 제공 정책에 따라 회원에게 폭죽 제공 | 고범수, 황대선 |
| 로그인  | 카카오 로그인 활용 | 김유선 |
| 사용자별 접근 권한 | 시큐리티를 이용한 접근 권한 설정 | 김유선 |
| 인스타그램 연동 및 공유 | 인스타그램 연동과 축팅에 올린 게시글을 인스타그램에 공유 | 김유선 |
| 카카오톡 문의 | 카카오톡 채널에 문의 | 김유선 |
| 마이페이지 | 사용자 게시물 및 보유 폭죽 그리고 총 게시물 조회수 제공 | 송가은 |
| 알림 | 카카오톡 알림 제공 | 송가은 |

## DB 설계

![ERD_chookting](https://github.com/Step3-kakao-tech-campus/Team14_BE/assets/91835827/7ac4a3cf-7d3e-40ef-a3ee-f4df0571b36f)



## 컨벤션


- Commit Convention

  [Commit Convention · Issue #20 · Step3-kakao-tech-campus/Team14_BE](https://github.com/Step3-kakao-tech-campus/Team14_BE/issues/20)

- Branch Naming Convention

  [Branch Naming Convention · Issue #9 · Step3-kakao-tech-campus/Team14_BE](https://github.com/Step3-kakao-tech-campus/Team14_BE/issues/9)


## 팀원


<table>
  <tr>
    <td align="center"><a href="https://github.com/GoBeromsu"><img src="https://github.com/GoBeromsu.png" width="50"></a></td>
    <td align="center"><a href="https://github.com/hwangdaesun"><img src="https://github.com/hwangdaesun.png" width="50"></a></td>
    <td align="center"><a href="https://github.com/SongGaEun16"><img src="https://github.com/SongGaEun16.png" width="50"></a></td>
    <td align="center"><a href="https://github.com/yuseonkim"><img src="https://github.com/yuseonkim.png" width="50"></a></td>
  </tr>
  <tr>
    <td align="center"><a href="https://github.com/GoBeromsu">GoBeromsu</a></td>
    <td align="center"><a href="https://github.com/hwangdaesun">hwangdaesun</a></td>
    <td align="center"><a href="https://github.com/SongGaEun16">SongGaEun16</a></td>
    <td align="center"><a href="https://github.com/yuseonkim">yuseonkim</a></td>
  </tr>
<table>




# Team14_BE
14조
## 카카오 테크 캠퍼스 3단계 진행 보드

</br>

## 배포와 관련하여

```

최종 배포는 크램폴린으로 배포해야 합니다.

하지만 배포 환경의 불편함이 있는 경우를 고려하여

임의의 배포를 위해 타 배포 환경을 자유롭게 이용해도 됩니다. (단, 금액적인 지원은 어렵습니다.)

아래는 추가적인 설정을 통해 (체험판, 혹은 프리 티어 등)무료로 클라우드 배포가 가능한 서비스입니다.

ex ) AWS(아마존), GCP(구글), Azure(마이크로소프트), Cloudtype

```
## Notice

```
필요 산출물들은 수료 기준에 영향을 주는 것은 아니지만,
주차 별 산출물을 기반으로 평가가 이루어 집니다.

주차 별 평가 점수는 추 후 최종 평가에 최종 합산 점수로 포함됩니다.
```

![레포지토리 운영-001 (1)](https://github.com/Step3-kakao-tech-campus/practice/assets/138656575/acb0dccd-0441-4200-999a-981865535d5f)
![image](https://github.com/Step3-kakao-tech-campus/practice/assets/138656575/b42cbc06-c5e7-4806-8477-63dfa8e807a0)

[git flowchart_FE.pdf](https://github.com/Step3-kakao-tech-campus/practice/files/12521045/git.flowchart_FE.pdf)


</br>

## 필요 산출물
<details>
<summary>Step3. Week-1</summary>
<div>

✅**1주차**

```
    - 5 Whys
    - 마켓 리서치
    - 페르소나 & 저니맵
    - 와이어 프레임
    - 칸반보드
```

</div>
</details>

---

<details>
<summary>Step3. Week-2</summary>
<div>

✅**2주차**

```
    - ERD 설계서

    - API 명세서
```

</div>
</details>

---

<details>
<summary>Step3. Week-3</summary>
<div>

✅**3주차**

```
    - 최종 기획안
```

</div>
</details>

---

<details>
<summary>Step3. Week-4</summary>
<div>

✅**4주차**

### **프로젝트 개발 환경 설정**

- `.editorconfig` 파일 추가로 코드 스타일을 팀 전체에 일관되게 적용.
- 다양한 개발 환경에 대응할 수 있는 `.gitignore` 파일 추가.
- GitHub Actions CI 설정으로 `weekly` 브랜치 PR에 대한 CI 워크플로우 구성.
  - 프로젝트 빌드 실패 시 알림 설정.

### **게시글 및 파일 관리 기능 구현**

- 게시글 업로드 및 파일 관리 기능 구현:
  - Post, Image, Member 엔터티 및 레포지터리 구현.
  - ApiResponse, Error 클래스 추가로 API 응답과 예외 처리 구현.
  - FileUtils, UploadFileDTO 구현으로 파일 관리 로직 구현.
  - 클린 아키텍처를 고려한 usecase와 service 로직 구현.
  - PostController와 UploadPostRequestDTO 구현으로 게시글 업로드 API 엔드포인트 구현.
- 웹서버 파일 저장 로직 및 DTO 클래스 구현:
  - FileUtils 클래스에서는 웹서버의 정적 파일 저장 로직 구현.
  - UploadFileDTO 클래스를 통해 파일의 원본 이름과 저장된 이름 관리.
- 메시지 코드 enum 클래스 추가로 공통으로 사용될 메시지 코드 관리.
- API 응답 및 예외 관련 코드 구현:
  - API 응답 처리를 위한 ApiResponse 클래스와 예외 처리를 위한 Error 클래스 추가.
  - ApiResponseGenerator 유틸리티 클래스 구현으로 응답 생성을 간편하게 함.
- 데이터베이스 설정, 컴포넌트 스캔, build.gradle 의존성 추가:
  - 필요한 설정과 의존성을 build.gradle에 추가.
  - WebConfig.java에서 이미지 경로 설정.

### 인기 피드 상세 조회 및 레디스 관련 설정

1. **Redis 및 Cache 설정**:
  - Redis와 Cache 관련 세팅을 진행하여 기반 환경을 구축.
2. **인기 피드 상세 조회 기능 구현**:
  - 홈 피드 게시글 상세 조회와 인기 게시글 상세 조회를 분리하여 구현.
  - 인기 게시글 상세 조회에 Look Aside 캐시 전략 사용.
3. **조회수 DB 반영 기능 구현**:
  - 10분 주기로 조회수를 DB에 반영하는 기능 구현.
  - 조회수의 빈번한 변동과 캐시 서버 문제 대응을 위해 Write Back 캐시 전략 사용.
4. **중복 조회수 방지 기능**:
  - Redis의 Set 자료구조를 사용해 한 게시글당 한 사람만 조회수가 늘어나도록 구현.
5. **메서드 및 테스트 추가**:
  - 게시글 조회수를 레디스에 저장하는 메서드 추가.
  - 인기 게시글 가져오는 메서드 생성.
  - 10분 주기로 레디스 서버에서 게시글당 조회수를 조회해 DB에 반영하는 기능 구현.
  - 관련 테스트 케이스 작성 및 검증.
6. **기타**:
  - **`spring-boot-configuration-processor`** 추가.
  - **`jpa.hibernate.ddl-auto`**를 create로 변경.
  - Member Constructor 수정, fetch 전략 수정 등의 리팩토링 작업 진행.

### Swagger 3.0 추가

- SwaggerConfig.java 설정 파일 추가로 Swagger 3.0 API 문서화 활성화.
- 설정에서 **`@RestController`** 애노테이션이 있는 컨트롤러만 문서화 대상으로 포함.
- 애플리케이션 프로퍼티에서 매칭 전략 설정으로 swagger 3.0 경로 에러 해결

### 홈 피드 조회 기능 구현

1. **홈 피드 조회 기능 구현**
  - **`PostService`** 클래스에서 홈 피드를 조회하는 로직 구현.
  - **`FindPostListUsecase`**를 이용하여 최신 순으로 10개의 Post 게시물을 가져옴.
2. **무한 스크롤 기능 구현**:
  - 엔드포인트 **`@GetMapping("/post")`**를 구현, **`lastPostId`** 파라미터 기반의 no offset 방식 사용.
  - 요청 시 마다 지정된 **`size`**만큼 게시글 반환, 클라이언트는 **`lastPostId`**를 통해 다음 요청의 시작점을 알 수 있음.
3. **무한 스크롤 기능 최적화**:
  - 무한 스크롤 로직에 **`hasNext`** 플래그 도입, 클라이언트에게 더 많은 데이터의 존재를 알림.
  - **`FindPostListUsecase`**의 **`execute`** 메서드 수정, 반환된 게시글의 수가 요청된 **`size`**보다 큰 경우 **`hasNext`** 플래그를 **`true`**로 설정.

### tearDown **SQL 추가**

- 테스트용 초기 데이터 생성 SQL 스크립트 추가.
- **`member`**, **`image`**, **`post`** 테이블의 데이터 재설정 및 새 레코드 삽입, 무한 스크롤 및 기타 기능 테스트에 활용

### 카카오 OAuth2를 사용한 로그인 및 회원가입, 엑세스토큰 발급 및 검증 기능 구현

1. **의존성 및 설정**:
  - **`build.gradle`**에 SpringSecurity, OAuth2Client, java-jwt 의존성을 추가.
  - **`application.properties`**에 OAuth2 관련 설정을 작성.
2. **사용자 관리 및 권한 설정**:
  - 사용자 관리를 위한 **`PrincipalDetails`** 클래스 작성.
  - 권한 설정 및 로그인을 위한 **`SecurityConfig`** 클래스 작성.
3. **JWT 생성 및 검증**:
  - **`JwtProvider`**와 **`JwtAuthenticationFilter`** 클래스를 작성하여 JWT 생성 및 검증 구현.
4. **로그인 로직**:
  - 로그인 완료 시 필요한 로직을 실행하기 위한 **`AuthenticationSuccessHandler`**와 **`PrincipalOAuth2UserService`** 클래스 작성.
  - 로그인을 위한 **`Member`** 엔티티, **`MemberRepository`**, **`TokenDTO`**, **`LoginController`** 클래스 작성.

</div>
</details>

---
<details>
<summary>Step3. Week-5</summary>
<div>

✅**5주차**

### 황대선

- 인기 피드 정책 구현 및 관련 문서화.
- **`Instant`** 클래스 도입으로 **`Post`** 엔터티의 **`createdAt`** 컬럼의 자료형을 **`Instant`**로 변경하여 정확한 시간 비교 가능 ([#43](https://github.com/Step3-kakao-tech-campus/Team14_BE/issues/43)).
- 게시물 나이 및 인기도 업데이트 기능 구현 및 스케줄링 테스트 ([#48](https://github.com/Step3-kakao-tech-campus/Team14_BE/pull/48), [#50](https://github.com/Step3-kakao-tech-campus/Team14_BE/pull/50)).
- 인기도 높은 게시물 선별 후 Redis에 저장 기능 구현 ([#55](https://github.com/Step3-kakao-tech-campus/Team14_BE/pull/55)).
- Redis에서 인기도가 높은 상위 300개의 게시물 조회 기능 구현 ([#59](https://github.com/Step3-kakao-tech-campus/Team14_BE/pull/59)).

### 고범수
 
- 단일 게시물에 좋아요 기능 추가로 유저가 좋아요를 누르면 바로 DB로 업데이트 기능 구현 ([#54](https://github.com/Step3-kakao-tech-campus/Team14_BE/pull/54)).
- 단일 게시물에 유저가 좋아요를 누르고, 반영되는 순간에 해당 게시물의 좋아요 갯수를 업데이트하는 로직 구현 ([#60](https://github.com/Step3-kakao-tech-campus/Team14_BE/pull/60)).

### 김유선

- 로그인 완료 시 리프레시 토큰을 발급 및 Redis에 저장 기능 구현 ([#57](https://github.com/Step3-kakao-tech-campus/Team14_BE/pull/57)).
- 기존 엑세스 토큰 만료 시 리프레시 토큰을 사용해 엑세스 토큰을 새로 재발급하는 기능 구현 ([#57](https://github.com/Step3-kakao-tech-campus/Team14_BE/pull/57)).

### 송가은

- MyPage
- DAO 클래스에 게시물 조회 메서드 추가
- 서블릿에서 게시물 조회 요청 처리
- JSP 파일 작성

</div>
</details>

---

<details>
<summary>Step3. Week-6</summary>
<div>

✅**6주차**

```
    - 6주차 github

    - 중간발표자료

    - 피어리뷰시트
```

</div>
</details>

---

<details>
<summary>Step3. Week-7</summary>
<div>

✅**7주차**

```
    - 7주차 github

    - 7주차 노션
```

</div>
</details>

---

<details>
<summary>Step3. Week-8</summary>
<div>

✅**8주차**

```
    - 중간고사

```

</div>
</details>

---

<details>
<summary>Step3. Week-9</summary>
<div>

✅**9주차**

```
    - 9주차 github

    - 9주차 노션
```

</div>
</details>

---

<details>
<summary>Step3. Week-10</summary>
<div>

✅**10주차**

```
    - 10주차 github

    - 테스트 시나리오 명세서

    - 테스트 결과 보고서
```

</div>
</details>

---

<details>
<summary>Step3. Week-11</summary>
<div>

✅**11주차**

```
    - 최종 기획안

    - 배포 인스턴스 링크
```

</div>
</details>

---

## **과제 상세 : 수강생들이 과제를 진행할 때, 유념해야할 것**

```
1. README.md 파일은 동료 개발자에게 프로젝트에 쉽게 랜딩하도록 돕는 중요한 소통 수단입니다.
해당 프로젝트에 대해 아무런 지식이 없는 동료들에게 설명하는 것처럼 쉽고, 간결하게 작성해주세요.

2. 좋은 개발자는 디자이너, 기획자, 마케터 등 여러 포지션에 있는 분들과 소통을 잘합니다.
UI 컴포넌트의 명칭과 이를 구현하는 능력은 필수적인 커뮤니케이션 스킬이자 필요사항이니 어떤 상황에서 해당 컴포넌트를 사용하면 좋을지 고민하며 코드를 작성해보세요.

```

</br>

## **코드리뷰 관련: review branch로 PR시, 아래 내용을 포함하여 코멘트 남겨주세요.**

**1. PR 제목과 내용을 아래와 같이 작성 해주세요.**

> PR 제목 : 부산대_0조_아이템명_0주차
>

</br>

</div>

---
